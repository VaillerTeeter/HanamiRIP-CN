# PowerShell（PS1）注释生成指令（Copilot）

## 目标
为指定的 PowerShell 脚本添加“傻子都能看懂”的详细中文注释。注释要覆盖脚本目的、参数含义、执行流程、错误处理与环境依赖。注释写在代码附近，不改变脚本行为。

## 代码范围
- 需要注释的文件列表：
  - "scripts\setup-env.ps1"
  - "scripts\banner.ps1"

## 输出要求（必须遵守）
1. **极度清晰**：对每个关键命令、变量、分支、循环都要解释“为什么这样做”。
2. **从零开始**：假设读者完全不了解 PowerShell，必要时解释管道、对象流、变量、作用域等概念。
3. **覆盖全面**：至少覆盖以下内容（按需选用，但不得遗漏适用项）：
   - 脚本用途与整体流程
   - 参数/变量的含义与默认值
   - 关键命令的输入输出
   - 条件判断与分支逻辑
   - 错误处理与退出条件
   - 对外部命令/文件/环境变量的依赖
   - 影响系统或文件的操作说明
4. **不改功能**：只加注释，不改逻辑、不重构、不改格式风格（除非注释必须换行）。
5. **注释风格**：
   - 使用 `#` 行注释；
   - 复杂说明可用多行 `#` 连续注释；
   - 注释紧贴相关代码上方或行尾。
6. **术语统一**：同一概念使用同一中文词汇，不要同义反复。
7. **示例优先**：复杂流程可给出简短示例（写在注释中，不改脚本）。

## 注释粒度示例（仅作为风格参考）
- 对函数：说明“做什么”“输入是什么”“输出是什么”“可能失败的原因”。
- 对变量：说明“代表什么”“为何这样命名”。
- 对分支：说明“什么时候进来”“为什么要特殊处理”。

## 禁止事项
- 不要删除现有注释
- 不要引入与脚本无关的内容
- 不要修改命令或参数

## 交付检查清单
- [ ] 关键变量/命令均有说明
- [ ] 错误路径与退出条件已解释
- [ ] 外部依赖已说明

## 备注
- 已补充文件列表，如需调整请直接修改上方列表。
- 最后更新：2026-02-06（初始第一版）。
